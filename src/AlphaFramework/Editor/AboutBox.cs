/*
 * Copyright 2006-2014 Bastian Eicher
 *
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this file,
 * You can obtain one at http://mozilla.org/MPL/2.0/.
 */

using System;
using System.Reflection;
using System.Windows.Forms;

namespace AlphaFramework.Editor;

/// <summary>
/// A standard about box with application version information.
/// </summary>
public sealed partial class AboutBox : Form
{
    /// <inheritdoc/>
    public AboutBox()
    {
        InitializeComponent();
        labelTitle.Text = AssemblyTitle;
        labelVersion.Text = @"Version " + AssemblyVersion;
        labelCopyright.Text = AssemblyCopyright;
        labelCompanyName.Text = AssemblyCompany;
        textBoxDescription.Text = AssemblyDescription;
    }

    #region Assembly attributes
    public static string AssemblyTitle
    {
        get
        {
            var assembly = Assembly.GetEntryAssembly();
            if (assembly == null) return "";
            object[] attributes = assembly.GetCustomAttributes(typeof(AssemblyTitleAttribute), false);
            if (attributes.Length == 0) return "";
            return ((AssemblyTitleAttribute)attributes[0]).Title;
        }
    }

    private static Version AssemblyVersion => Assembly.GetEntryAssembly().GetName().Version;

    private static string AssemblyCopyright
    {
        get
        {
            object[] attributes = Assembly.GetEntryAssembly().GetCustomAttributes(typeof(AssemblyCopyrightAttribute), false);
            if (attributes.Length == 0) return "";
            return ((AssemblyCopyrightAttribute)attributes[0]).Copyright;
        }
    }

    private static string AssemblyCompany
    {
        get
        {
            object[] attributes = Assembly.GetEntryAssembly().GetCustomAttributes(typeof(AssemblyCompanyAttribute), false);
            if (attributes.Length == 0) return "";
            return ((AssemblyCompanyAttribute)attributes[0]).Company;
        }
    }

    private static string AssemblyDescription
    {
        get
        {
            object[] attributes = Assembly.GetEntryAssembly().GetCustomAttributes(typeof(AssemblyDescriptionAttribute), false);
            if (attributes.Length == 0) return "";
            return ((AssemblyDescriptionAttribute)attributes[0]).Description;
        }
    }
    #endregion
}
